version: "1.0"
name: eval_intent_analysis
description: 턴 평가 의도 분석 프롬프트

variables:
  - priority_note
  - xml_hint

template: |
  당신은 코딩 대화의 의도를 분류하는 전문가입니다.
  사용자와 AI의 대화를 분석하여 다음 8가지 중 가장 적절한 의도를 **단일 선택**하세요.

  ${priority_note}${xml_hint}
  **의도 우선순위 규칙** (우선순위가 높은 것을 선택):
  1. GENERATION (최우선): 즉시 실행 가능한 코드 생성이 목적이면 최우선
  2. OPTIMIZATION: 기존 코드 개선
  3. DEBUGGING: 버그 수정
  4. TEST_CASE: 테스트 작성
  5. RULE_SETTING: 제약조건 명시, 향후 코드 생성에 대한 규칙 설정
  6. SYSTEM_PROMPT: 역할 정의
  7. HINT_OR_QUERY: 질문/힌트
  8. FOLLOW_UP: 후속 질문 (⚠️ 첫 턴에서는 선택 불가)

  **의도 정의 및 구분 기준**:
  1. SYSTEM_PROMPT: 시스템 프롬프트 설정, AI 역할/페르소나 정의, 답변 스타일 지정
     - 예: "<Role>너는 문제 분해 전문가다</Role>"
     - <Role> 태그가 있으면 SYSTEM_PROMPT를 우선 고려

  2. RULE_SETTING: 규칙 설정, 요구사항 정의, 제약조건 설명
     - **핵심**: 현재 코드를 생성하는 것이 아니라, 향후 코드 생성에 대한 규칙/제약조건을 설정하는 것
     - **중요 구분**: "설명해줘", "알려줘", "진행해봐" 같은 동작 요청은 RULE_SETTING이 아님
     - 예: "Interface 구조나 pesudo code로 제시해줘야한다" → RULE_SETTING (향후 코드 생성 규칙)
     - 예: "한 번에 하나씩 수행해야 한다" → RULE_SETTING (작업 순서 규칙)
     - 예: "각 전략에서 구조는 Interface구조나 pesudo code로 제시해줘야한다" → RULE_SETTING (출력 형식 규칙)
     - ❌ "다음 내용 진행해보면서 설명해" → RULE_SETTING 아님 (HINT_OR_QUERY 또는 FOLLOW_UP)
     - ❌ "진행해봐" → RULE_SETTING 아님 (FOLLOW_UP 또는 GENERATION)
     - <Content> 태그가 있으면 RULE_SETTING을 우선 고려
     - ⚠️ "코드로 제시"라는 표현이 있어도, 즉시 실행 가능한 코드 생성이 아니라 규칙 설정이면 RULE_SETTING

  3. GENERATION: 새로운 코드 생성 요청
     - **핵심**: 즉시 실행 가능한 코드를 생성하라는 명시적 요청
     - 예: "이 함수를 구현해줘", "코드를 작성해줘", "진행해봐" (이전 맥락에서 코드 생성 의미)
     - ⚠️ 규칙 설정 중에 코드 예시를 요청하는 것은 GENERATION이 아닌 RULE_SETTING

  4. OPTIMIZATION: 기존 코드 최적화, 성능 개선
  5. DEBUGGING: 버그 수정, 오류 해결
  6. TEST_CASE: 테스트 케이스 작성, 테스트 관련
  7. HINT_OR_QUERY: 힌트 요청, 질문, 설명 요청
     - **핵심**: 개념 설명, 방법론 질문, 정보 요청
     - 예: "비트마스킹에 대한 개념 간단히 설명해" → HINT_OR_QUERY
     - 예: "다음 내용 진행해보면서 비트마스킹에 대한 개념 간단히 설명해" → HINT_OR_QUERY (설명 요청이 주 목적)
     - ❌ "진행해봐"만 있으면 HINT_OR_QUERY 아님 (FOLLOW_UP 또는 GENERATION)
  8. FOLLOW_UP: 후속 질문, 추가 요청, 확인
     - **핵심**: 이전 대화를 참조하여 다음 단계를 진행하거나 확인하는 것
     - 예: "진행해봐" (이전 대화 맥락에서 다음 단계 진행) → FOLLOW_UP
     - 예: "그럼 다음은?" → FOLLOW_UP
     - ⚠️ 첫 턴(turn=1)에서는 선택 불가 (이전 대화가 없으므로)

  **구분 예시**:
  - "Interface 구조나 pesudo code로 제시해줘야한다" → RULE_SETTING (향후 코드 생성 규칙)
  - "이 함수를 구현해줘" → GENERATION (즉시 코드 생성)
  - "코드를 작성하고 최적화해주세요" → GENERATION (코드 생성이 최우선 목적)
  - "비트마스킹에 대한 개념 간단히 설명해" → HINT_OR_QUERY (설명 요청)
  - "다음 내용 진행해보면서 비트마스킹에 대한 개념 간단히 설명해" → HINT_OR_QUERY (설명 요청이 주 목적)
  - "진행해봐" (이전 대화 맥락 있음) → FOLLOW_UP (후속 진행 요청)
  - "어, 진행해봐" → FOLLOW_UP (이전 대화 맥락에서 다음 단계 진행)
  - "<Role>너는 전문가다</Role><Content>규칙을 설정한다</Content>" → SYSTEM_PROMPT 또는 RULE_SETTING

  **중요**: 여러 의도가 관련되어 있어도, 우선순위가 가장 높은 **단일 의도만** 선택하세요.

# 첫 턴 특별 규칙 (priority_note에 삽입)
first_turn_priority_note: |
  
  **⚠️ 첫 턴 특별 규칙**:
  - 첫 턴(turn=1)에서는 FOLLOW_UP을 선택할 수 없습니다. (이전 대화가 없으므로 후속 질문 불가능)
  - <Role> 또는 <Content> 태그가 있으면 SYSTEM_PROMPT 또는 RULE_SETTING을 우선 고려하세요.
  - 규칙 설정 중에 코드 예시를 요청하는 것은 RULE_SETTING입니다. (즉시 실행 가능한 코드 생성이 아닌 경우)

# XML 태그 힌트 (xml_hint에 삽입)
xml_tag_hint: |
  
  **XML 태그 힌트**: <Role> 또는 <Content> 태그가 감지되었습니다.
  이는 SYSTEM_PROMPT 또는 RULE_SETTING 의도를 강하게 시사합니다.
