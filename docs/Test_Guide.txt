================================================================================
                        Test Guide
                LangGraph í…ŒìŠ¤íŠ¸ ë° ë””ë²„ê¹… ê°€ì´ë“œ
                ì‘ì„±ì¼: 2025-11-27
================================================================================

## ğŸ“‹ ëª©ì°¨
1. í…ŒìŠ¤íŠ¸ íŒŒì¼ êµ¬ì¡° ë° ì‹¤í–‰ ë°©ë²•
2. ì„œë²„ ë¡œê·¸ í™•ì¸ ë°©ë²•
3. Docker ì»¨í…Œì´ë„ˆ ë¡œê·¸ í™•ì¸ ë°©ë²•
4. Redis ì„¸ì…˜ ë°ì´í„° í™•ì¸ ë°©ë²•
5. PostgreSQL ë°ì´í„° í™•ì¸ ë°©ë²•
6. ì¼ë°˜ì ì¸ ë¬¸ì œ í•´ê²° ë°©ë²•

================================================================================
## 1. í…ŒìŠ¤íŠ¸ íŒŒì¼ êµ¬ì¡° ë° ì‹¤í–‰ ë°©ë²•
================================================================================

### 1.1 í…ŒìŠ¤íŠ¸ íŒŒì¼ ëª©ë¡

#### ğŸ“ `tests/test_api.py`
**ì—­í• :**
- FastAPI ì—”ë“œí¬ì¸íŠ¸ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- pytest ê¸°ë°˜ ìë™í™” í…ŒìŠ¤íŠ¸

**í…ŒìŠ¤íŠ¸ í•­ëª©:**
- í—¬ìŠ¤ ì²´í¬ API
- ì±„íŒ… ë©”ì‹œì§€ API
- ì½”ë“œ ì œì¶œ API
- ì„¸ì…˜ ìƒíƒœ ì¡°íšŒ API

**ì‹¤í–‰ ë°©ë²•:**
```bash
# ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰
cd C:\P_project\LangGraph_1
uv run pytest tests/test_api.py -v

# íŠ¹ì • í…ŒìŠ¤íŠ¸ë§Œ ì‹¤í–‰
uv run pytest tests/test_api.py::test_health_check -v

# ìƒì„¸ ì¶œë ¥
uv run pytest tests/test_api.py -v -s
```

**ì˜ˆìƒ ê²°ê³¼:**
```
tests/test_api.py::test_health_check PASSED
tests/test_api.py::test_message_endpoint PASSED
tests/test_api.py::test_submit_endpoint PASSED
tests/test_api.py::test_get_state_endpoint PASSED
```

---

#### ğŸ“ `test_submit_only.py`
**ì—­í• :**
- ì‹¤ì œ ì±„íŒ… â†’ ì œì¶œ í”Œë¡œìš° í†µí•© í…ŒìŠ¤íŠ¸
- 3í„´ ëŒ€í™” + ì œì¶œ

**ì‹œë‚˜ë¦¬ì˜¤:**
```
Turn 1: "í”¼ë³´ë‚˜ì¹˜ í•¨ìˆ˜ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”"
Turn 2: "O(n)ìœ¼ë¡œ ìµœì í™”í•´ì£¼ì„¸ìš”"
Turn 3: "ì—ì§€ ì¼€ì´ìŠ¤ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”"
ì œì¶œ: def fib(n): return n if n <= 1 else fib(n-1) + fib(n-2)
```

**ì‹¤í–‰ ë°©ë²•:**
```bash
cd C:\P_project\LangGraph_1
chcp 65001  # UTF-8 ì¸ì½”ë”©
uv run python test_submit_only.py
```

**ì˜ˆìƒ ì¶œë ¥:**
```
Session: submit-test-20251127-041843

[Turn 1] í”¼ë³´ë‚˜ì¹˜ í•¨ìˆ˜ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”...
  [OK] AI ì‘ë‹µ: 795ì

[Turn 2] O(n)ìœ¼ë¡œ ìµœì í™”í•´ì£¼ì„¸ìš”...
  [OK] AI ì‘ë‹µ: 1362ì

[Turn 3] ì—ì§€ ì¼€ì´ìŠ¤ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”...
  [OK] AI ì‘ë‹µ: 5537ì

[ì œì¶œ] ì½”ë“œ ì œì¶œ...
  ì œì¶œ ì™„ë£Œ: True
  ìµœì¢… ì ìˆ˜: 64.25 (D)
  í„´ ì ìˆ˜: {'1': 85.5, '2': 92.0, '3': 78.3}
```

---

#### ğŸ“ `test_submit_with_delay.py`
**ì—­í• :**
- ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ì™„ë£Œ ëŒ€ê¸° í¬í•¨ í…ŒìŠ¤íŠ¸
- Turn 3 í‰ê°€ ì™„ë£Œë¥¼ ê¸°ë‹¤ë¦° í›„ ì œì¶œ

**ì°¨ì´ì :**
```python
await chat("ì—ì§€ ì¼€ì´ìŠ¤ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”", 3)

# â˜… 5ì´ˆ ëŒ€ê¸° ì¶”ê°€
print("[ëŒ€ê¸°] Turn 3 ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ì™„ë£Œ ëŒ€ê¸° (5ì´ˆ)...")
await asyncio.sleep(5)

await submit(code)
```

**ì‹¤í–‰ ë°©ë²•:**
```bash
cd C:\P_project\LangGraph_1
chcp 65001
uv run python test_submit_with_delay.py
```

---

#### ğŸ“ `test_chat_flow.py`
**ì—­í• :**
- ì „ì²´ í”Œë¡œìš° ìƒì„¸ í…ŒìŠ¤íŠ¸
- Redis turn_logs ì§ì ‘ í™•ì¸ í¬í•¨

**ì¶”ê°€ ê¸°ëŠ¥:**
```python
async def check_turn_logs():
    """Redisì— ì €ì¥ëœ turn_logs í™•ì¸"""
    import redis.asyncio as redis
    r = await redis.Redis(host='localhost', port=6379, db=0, decode_responses=True)
    
    async for key in r.scan_iter(f"turn_logs:{SESSION_ID}:*"):
        log = await r.get(key)
        print(f"Turn {key.split(':')[-1]}: {log}")
```

**ì‹¤í–‰ ë°©ë²•:**
```bash
cd C:\P_project\LangGraph_1
chcp 65001
uv run python test_chat_flow.py
```

---

### 1.2 í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

#### âœ… í•„ìˆ˜ ì¤€ë¹„ ì‚¬í•­
```bash
# 1. Docker ì»¨í…Œì´ë„ˆ ì‹¤í–‰ í™•ì¸
docker ps --filter "name=ai_vibe"

# ì˜ˆìƒ ê²°ê³¼:
# ai_vibe_redis_dev      Up X hours (healthy)
# ai_vibe_postgres_dev   Up X hours (healthy)

# 2. FastAPI ì„œë²„ ì‹¤í–‰
cd C:\P_project\LangGraph_1
uv run scripts/run_dev.py

# 3. ì„œë²„ ì •ìƒ ì‹œì‘ í™•ì¸ (ë³„ë„ í„°ë¯¸ë„)
# ë¡œê·¸ì—ì„œ í™•ì¸:
# - "Redis ì—°ê²° ì„±ê³µ"
# - "PostgreSQL ì—°ê²° ì„±ê³µ"
# - "Application startup complete"

# 4. ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
curl http://localhost:8000/health
# ì˜ˆìƒ: {"status": "ok"}
```

---

### 1.3 í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ìˆœì„œ (ê¶Œì¥)

```bash
# 1ë‹¨ê³„: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
uv run pytest tests/test_api.py -v

# 2ë‹¨ê³„: ê°„ë‹¨ í†µí•© í…ŒìŠ¤íŠ¸
uv run python test_submit_only.py

# 3ë‹¨ê³„: ëŒ€ê¸° ì‹œê°„ í¬í•¨ í…ŒìŠ¤íŠ¸
uv run python test_submit_with_delay.py

# 4ë‹¨ê³„: ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸
uv run python test_chat_flow.py
```

================================================================================
## 2. ì„œë²„ ë¡œê·¸ í™•ì¸ ë°©ë²•
================================================================================

### 2.1 ì‹¤ì‹œê°„ ì„œë²„ ë¡œê·¸ í™•ì¸

#### ë°©ë²• 1: í„°ë¯¸ë„ íŒŒì¼ ì§ì ‘ ì½ê¸° (ì¶”ì²œ)
```powershell
# í„°ë¯¸ë„ í´ë” ìœ„ì¹˜
cd C:\Users\YSH\.cursor\projects\c-Users-YSH-AppData-Roaming-Cursor-Workspaces-1762325051351-workspace-json\terminals

# ë˜ëŠ” ê°„ë‹¨íˆ
cd $env:USERPROFILE\.cursor\projects\<workspace-hash>\terminals

# í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í„°ë¯¸ë„ í™•ì¸
Get-ChildItem | Sort-Object LastWriteTime -Descending | Select-Object -First 3

# ì˜ˆìƒ ì¶œë ¥:
# Name     LastWriteTime           Length
# 10.txt   2025-11-27 ì˜¤í›„ 4:26    15234  â† ê°€ì¥ ìµœê·¼ (ì„œë²„ ë¡œê·¸)
# 1.txt    2025-11-27 ì˜¤í›„ 3:49     5802
```

**ì„œë²„ ë¡œê·¸ íŒŒì¼ ì°¾ê¸°:**
- `active_command`ì— `run_dev.py`ê°€ ìˆëŠ” íŒŒì¼ì´ ì„œë²„ ë¡œê·¸

**ì‹¤ì‹œê°„ ë¡œê·¸ ë³´ê¸°:**
```powershell
# ë§ˆì§€ë§‰ 50ì¤„ ë³´ê¸°
Get-Content 10.txt -Tail 50

# ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ (ìƒˆ ë¡œê·¸ ìë™ ì¶œë ¥)
Get-Content 10.txt -Wait -Tail 20

# íŠ¹ì • í‚¤ì›Œë“œ ê²€ìƒ‰
Get-Content 10.txt | Select-String "ERROR"
Get-Content 10.txt | Select-String "session_id: submit-test"
```

---

#### ë°©ë²• 2: PowerShellë¡œ ë¡œê·¸ í•„í„°ë§

**íŠ¹ì • ì„¸ì…˜ ë¡œê·¸ë§Œ ë³´ê¸°:**
```powershell
$session = "submit-test-20251127-041843"
Get-Content 10.txt | Select-String $session
```

**íŠ¹ì • ë…¸ë“œ ë¡œê·¸ë§Œ ë³´ê¸°:**
```powershell
# Eval Turn Guard ë¡œê·¸
Get-Content 10.txt | Select-String "Eval Turn Guard"

# Intent Analyzer ë¡œê·¸
Get-Content 10.txt | Select-String "Intent Analyzer"

# ì—ëŸ¬ë§Œ ë³´ê¸°
Get-Content 10.txt | Select-String "ERROR|Exception|Failed"
```

**íƒ€ì„ìŠ¤íƒ¬í”„ë¡œ ì •ë ¬:**
```powershell
# ìµœê·¼ 100ì¤„ë§Œ
Get-Content 10.txt -Tail 100

# íŠ¹ì • ì‹œê°„ ì´í›„
Get-Content 10.txt | Select-String "2025-11-27 04:2"
```

**ì»¨í…ìŠ¤íŠ¸ í¬í•¨ ê²€ìƒ‰:**
```powershell
# í‚¤ì›Œë“œ ì „í›„ 3ì¤„ì”© í‘œì‹œ
Get-Content 10.txt | Select-String "Eval Turn Guard" -Context 3,3
```

---

### 2.2 ë¡œê·¸ ë ˆë²¨ë³„ ë¶„ë¥˜

#### INFO ë¡œê·¸
```powershell
Get-Content 10.txt | Select-String " - INFO - "
```

**ì£¼ìš” INFO ë¡œê·¸:**
- `[1. Handle Request] ì§„ì…/ì™„ë£Œ`
- `[2. Intent Analyzer] ë¶„ì„ ì™„ë£Œ`
- `[3. Writer LLM] ë‹µë³€ ìƒì„± ì„±ê³µ`
- `[4. Eval Turn Guard] ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ëŒ€ê¸°`
- `[6a. Eval Holistic Flow] ì™„ë£Œ`

#### WARNING ë¡œê·¸
```powershell
Get-Content 10.txt | Select-String " - WARNING - "
```

**ì£¼ìš” WARNING ë¡œê·¸:**
- `[4. Eval Turn Guard] ëˆ„ë½ëœ í„´ ë°œê²¬`
- `[6b. Aggregate Turn Scores] í„´ ì ìˆ˜ ì—†ìŒ`
- `Rate limit ë„ë‹¬`

#### ERROR ë¡œê·¸
```powershell
Get-Content 10.txt | Select-String " - ERROR - "
```

**ì£¼ìš” ERROR ë¡œê·¸:**
- `[Writer LLM] ì—ëŸ¬ ë°œìƒ`
- `[4.X ë‹µë³€ ìš”ì•½] ì˜¤ë¥˜`
- `429 Quota ì´ˆê³¼`
- `íƒ€ì„ì•„ì›ƒ`

---

### 2.3 ë…¸ë“œë³„ í”Œë¡œìš° ì¶”ì 

#### ì¼ë°˜ ì±„íŒ… í”Œë¡œìš° ì¶”ì 
```powershell
$session = "submit-test-20251127-041843"

# 1ë²ˆ ë…¸ë“œ
Get-Content 10.txt | Select-String "$session.*Handle Request"

# 2ë²ˆ ë…¸ë“œ
Get-Content 10.txt | Select-String "$session.*Intent Analyzer"

# 3ë²ˆ ë…¸ë“œ
Get-Content 10.txt | Select-String "$session.*Writer LLM"

# 4ë²ˆ ë…¸ë“œ (ë°±ê·¸ë¼ìš´ë“œ)
Get-Content 10.txt | Select-String "$session.*4\."
```

#### ì œì¶œ í”Œë¡œìš° ì¶”ì 
```powershell
$session = "submit-test-20251127-041843"

# ì „ì²´ í”Œë¡œìš°
Get-Content 10.txt | Select-String $session | Select-String "ì§„ì…|ì™„ë£Œ|Guard|Holistic|Aggregate|Performance|Correctness"
```

---

### 2.4 í„´ë³„ ë¡œê·¸ ì¶”ì 

```powershell
$session = "submit-test-20251127-041843"

# Turn 1 ë¡œê·¸
Get-Content 10.txt | Select-String "$session.*turn: 1"

# Turn 2 ë¡œê·¸
Get-Content 10.txt | Select-String "$session.*turn: 2"

# Turn 3 ë¡œê·¸
Get-Content 10.txt | Select-String "$session.*turn: 3"
```

---

### 2.5 ì„±ëŠ¥ ë¶„ì„

#### LLM í˜¸ì¶œ ì‹œê°„ ì¸¡ì •
```powershell
# Writer LLM í˜¸ì¶œ ì‹œê°„
Get-Content 10.txt | Select-String "Writer LLM.*ì‹œì‘"
Get-Content 10.txt | Select-String "Writer LLM.*ì„±ê³µ"
# ë‘ íƒ€ì„ìŠ¤íƒ¬í”„ ì°¨ì´ ê³„ì‚°
```

#### ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ì‹œê°„ ì¸¡ì •
```powershell
Get-Content 10.txt | Select-String "4ë²ˆ ë…¸ë“œ ë°±ê·¸ë¼ìš´ë“œ.*ì‹œì‘"
Get-Content 10.txt | Select-String "4ë²ˆ ë…¸ë“œ ë°±ê·¸ë¼ìš´ë“œ.*ì™„ë£Œ"
```

#### ì „ì²´ ì œì¶œ í”Œë¡œìš° ì‹œê°„
```powershell
Get-Content 10.txt | Select-String "ì½”ë“œ ì œì¶œ ìˆ˜ì‹ "
Get-Content 10.txt | Select-String "LangGraph ì‹¤í–‰ ì™„ë£Œ"
```

================================================================================
## 3. Docker ì»¨í…Œì´ë„ˆ ë¡œê·¸ í™•ì¸ ë°©ë²•
================================================================================

### 3.1 ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸

```bash
# ëª¨ë“  AI Vibe ì»¨í…Œì´ë„ˆ ìƒíƒœ
docker ps --filter "name=ai_vibe"

# ì˜ˆìƒ ì¶œë ¥:
# NAMES                  STATUS                 PORTS
# ai_vibe_postgres_dev   Up 2 hours (healthy)   0.0.0.0:5435->5432/tcp
# ai_vibe_redis_dev      Up 2 hours (healthy)   0.0.0.0:6379->6379/tcp

# ìƒì„¸ ì •ë³´
docker ps --filter "name=ai_vibe" --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"

# ëª¨ë“  ì»¨í…Œì´ë„ˆ (ì¤‘ë‹¨ëœ ê²ƒ í¬í•¨)
docker ps -a --filter "name=ai_vibe"
```

---

### 3.2 Redis ë¡œê·¸ í™•ì¸

```bash
# ì‹¤ì‹œê°„ ë¡œê·¸ (ìµœê·¼ 100ì¤„)
docker logs ai_vibe_redis_dev --tail 100

# ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
docker logs ai_vibe_redis_dev --follow

# íŠ¹ì • ì‹œê°„ ì´í›„ ë¡œê·¸
docker logs ai_vibe_redis_dev --since "2025-11-27T04:00:00"

# íƒ€ì„ìŠ¤íƒ¬í”„ í¬í•¨
docker logs ai_vibe_redis_dev --timestamps --tail 50

# ì—ëŸ¬ë§Œ ë³´ê¸°
docker logs ai_vibe_redis_dev 2>&1 | findstr "error|warning"
```

**Redis ë¡œê·¸ì—ì„œ í™•ì¸ ê°€ëŠ¥í•œ ì •ë³´:**
- Redis ì„œë²„ ì‹œì‘/ì¤‘ë‹¨
- ì—°ê²° ìˆ˜
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
- ì»¤ë§¨ë“œ ì‹¤í–‰ (CONFIG ì„¤ì • ì‹œ)

**ì£¼ì˜:** 
- ê¸°ë³¸ì ìœ¼ë¡œ RedisëŠ” ëª¨ë“  ëª…ë ¹ì„ ë¡œê·¸ì— ë‚¨ê¸°ì§€ ì•ŠìŒ
- `redis.conf`ì—ì„œ `loglevel debug` ì„¤ì • í•„ìš” (ê°œë°œ í™˜ê²½)

---

### 3.3 PostgreSQL ë¡œê·¸ í™•ì¸

```bash
# ì‹¤ì‹œê°„ ë¡œê·¸ (ìµœê·¼ 100ì¤„)
docker logs ai_vibe_postgres_dev --tail 100

# ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
docker logs ai_vibe_postgres_dev --follow

# SQL ì¿¼ë¦¬ ë¡œê·¸ ë³´ê¸°
docker logs ai_vibe_postgres_dev 2>&1 | findstr "SELECT|INSERT|UPDATE|DELETE"

# ì—ëŸ¬ë§Œ ë³´ê¸°
docker logs ai_vibe_postgres_dev 2>&1 | findstr "ERROR|FATAL|WARNING"
```

**PostgreSQL ë¡œê·¸ì—ì„œ í™•ì¸ ê°€ëŠ¥í•œ ì •ë³´:**
- DB ì—°ê²°/ì¢…ë£Œ
- SQL ì¿¼ë¦¬ ì‹¤í–‰
- ì—ëŸ¬ (ì œì•½ ì¡°ê±´ ìœ„ë°˜, íƒ€ì… ì˜¤ë¥˜ ë“±)
- ì„±ëŠ¥ (ëŠë¦° ì¿¼ë¦¬)

---

### 3.4 Docker ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘

```bash
# Redisë§Œ ì¬ì‹œì‘
docker restart ai_vibe_redis_dev

# PostgreSQLë§Œ ì¬ì‹œì‘
docker restart ai_vibe_postgres_dev

# ëª¨ë“  AI Vibe ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
docker restart ai_vibe_redis_dev ai_vibe_postgres_dev

# ìƒíƒœ í™•ì¸
docker ps --filter "name=ai_vibe"
```

---

### 3.5 ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì ‘ì†

#### Redis ì»¨í…Œì´ë„ˆ
```bash
# Redis CLI ì ‘ì†
docker exec -it ai_vibe_redis_dev redis-cli

# ëª…ë ¹ì–´ í•œ ë²ˆë§Œ ì‹¤í–‰
docker exec ai_vibe_redis_dev redis-cli KEYS "*"
docker exec ai_vibe_redis_dev redis-cli INFO
```

#### PostgreSQL ì»¨í…Œì´ë„ˆ
```bash
# psql ì ‘ì†
docker exec -it ai_vibe_postgres_dev psql -U ai_vibe_user -d ai_vibe_db

# ëª…ë ¹ì–´ í•œ ë²ˆë§Œ ì‹¤í–‰
docker exec ai_vibe_postgres_dev psql -U ai_vibe_user -d ai_vibe_db -c "SELECT * FROM exams;"
```

================================================================================
## 4. Redis ì„¸ì…˜ ë°ì´í„° í™•ì¸ ë°©ë²•
================================================================================

### 4.1 Redis CLI ê¸°ë³¸ ëª…ë ¹ì–´

#### Redis ì ‘ì†
```bash
docker exec -it ai_vibe_redis_dev redis-cli

# ë˜ëŠ” ë¡œì»¬ redis-cli ì‚¬ìš© (ì„¤ì¹˜ëœ ê²½ìš°)
redis-cli -h localhost -p 6379
```

---

### 4.2 í‚¤ ì¡°íšŒ

#### ëª¨ë“  í‚¤ ëª©ë¡
```redis
# ëª¨ë“  í‚¤ ë³´ê¸° (ê°œë°œ í™˜ê²½ë§Œ!)
KEYS *

# íŒ¨í„´ìœ¼ë¡œ ê²€ìƒ‰
KEYS turn_logs:*
KEYS graph_state:*
KEYS turn_mapping:*

# í‚¤ ê°œìˆ˜ í™•ì¸
DBSIZE
```

**ì£¼ì˜:** `KEYS *`ëŠ” í”„ë¡œë•ì…˜ì—ì„œ ì‚¬ìš© ê¸ˆì§€ (ë¸”ë¡œí‚¹)

#### SCANìœ¼ë¡œ ì•ˆì „í•˜ê²Œ ì¡°íšŒ
```redis
# ë°˜ë³µì ìœ¼ë¡œ í‚¤ ìŠ¤ìº”
SCAN 0 MATCH turn_logs:* COUNT 100
SCAN <cursor> MATCH turn_logs:* COUNT 100
# cursorê°€ 0ì´ ë  ë•Œê¹Œì§€ ë°˜ë³µ
```

---

### 4.3 ì„¸ì…˜ ìƒíƒœ ì¡°íšŒ

#### íŠ¹ì • ì„¸ì…˜ì˜ ê·¸ë˜í”„ ìƒíƒœ
```redis
# ì„¸ì…˜ ID ì˜ˆì‹œ
SET session_id submit-test-20251127-041843

# ê·¸ë˜í”„ ìƒíƒœ ì¡°íšŒ
GET graph_state:submit-test-20251127-041843

# JSON í˜•ì‹ìœ¼ë¡œ ì¶œë ¥ (redis-cli)
GET graph_state:submit-test-20251127-041843 | python -m json.tool
```

**PowerShellì—ì„œ:**
```powershell
# Redis GET í›„ JSON íŒŒì‹±
$session = "submit-test-20251127-041843"
$result = docker exec ai_vibe_redis_dev redis-cli GET "graph_state:$session"
$result | ConvertFrom-Json | ConvertTo-Json -Depth 10
```

---

### 4.4 í„´ ë¡œê·¸ ì¡°íšŒ

#### ëª¨ë“  í„´ ë¡œê·¸ í‚¤ ì°¾ê¸°
```redis
KEYS turn_logs:submit-test-20251127-041843:*

# ì˜ˆìƒ ì¶œë ¥:
# turn_logs:submit-test-20251127-041843:1
# turn_logs:submit-test-20251127-041843:2
# turn_logs:submit-test-20251127-041843:3
```

#### íŠ¹ì • í„´ ë¡œê·¸ ì¡°íšŒ
```redis
# Turn 1 ë¡œê·¸
GET turn_logs:submit-test-20251127-041843:1

# Turn 2 ë¡œê·¸
GET turn_logs:submit-test-20251127-041843:2
```

**PowerShellì—ì„œ ëª¨ë“  í„´ ë¡œê·¸ ì¡°íšŒ:**
```powershell
$session = "submit-test-20251127-041843"

# ëª¨ë“  í„´ ë¡œê·¸ í‚¤ ê°€ì ¸ì˜¤ê¸°
$keys = docker exec ai_vibe_redis_dev redis-cli KEYS "turn_logs:${session}:*"

# ê° í„´ ë¡œê·¸ ì¶œë ¥
foreach ($key in $keys) {
    Write-Host "`n=== $key ==="
    docker exec ai_vibe_redis_dev redis-cli GET $key | ConvertFrom-Json | ConvertTo-Json -Depth 5
}
```

---

### 4.5 í„´ ë§¤í•‘ ì¡°íšŒ

```redis
# í„´-ë©”ì‹œì§€ ì¸ë±ìŠ¤ ë§¤í•‘
GET turn_mapping:submit-test-20251127-041843

# ì˜ˆìƒ ì¶œë ¥:
# {"1": {"start_msg_idx": 0, "end_msg_idx": 1}, "2": {...}, "3": {...}}
```

**PowerShellì—ì„œ:**
```powershell
$session = "submit-test-20251127-041843"
docker exec ai_vibe_redis_dev redis-cli GET "turn_mapping:$session" | ConvertFrom-Json | ConvertTo-Json
```

---

### 4.6 ì ìˆ˜ ë°ì´í„° ì¡°íšŒ

```redis
# í‰ê°€ ì ìˆ˜
GET eval:scores:submit-test-20251127-041843

# ì˜ˆìƒ êµ¬ì¡°:
# {
#   "turns": {
#     "1": {...},
#     "2": {...}
#   },
#   "final": {...},
#   "completed_at": "2025-11-27T..."
# }
```

---

### 4.7 Redis ë°ì´í„° íƒ€ì… í™•ì¸

```redis
# í‚¤ì˜ íƒ€ì… í™•ì¸
TYPE graph_state:submit-test-20251127-041843
# ì˜ˆìƒ: string (JSON ë¬¸ìì—´)

TYPE turn_logs:submit-test-20251127-041843:1
# ì˜ˆìƒ: string

# TTL í™•ì¸ (ë‚¨ì€ ì‹œê°„)
TTL graph_state:submit-test-20251127-041843
# ì˜ˆìƒ: 3600 (1ì‹œê°„)
```

---

### 4.8 Redis ë°ì´í„° ì‚­ì œ/ì´ˆê¸°í™”

```redis
# íŠ¹ì • í‚¤ ì‚­ì œ
DEL graph_state:submit-test-20251127-041843

# íŒ¨í„´ìœ¼ë¡œ ì‚­ì œ (ì£¼ì˜!)
# Redis CLIì—ì„œëŠ” EVAL ì‚¬ìš©
EVAL "return redis.call('del', unpack(redis.call('keys', ARGV[1])))" 0 turn_logs:submit-test-*

# ë˜ëŠ” PowerShellë¡œ
docker exec ai_vibe_redis_dev redis-cli --scan --pattern "turn_logs:submit-test-*" | ForEach-Object { docker exec ai_vibe_redis_dev redis-cli DEL $_ }

# ëª¨ë“  ë°ì´í„° ì‚­ì œ (ê°œë°œ í™˜ê²½ë§Œ!)
FLUSHALL
```

---

### 4.9 ì‹¤ì „ ë””ë²„ê¹… ì˜ˆì‹œ

#### ì‹œë‚˜ë¦¬ì˜¤: "Turn 3ì´ turn_scoresì— ì—†ì–´ìš”"

```powershell
$session = "submit-test-20251127-041843"

# 1. turn_logsì— Turn 3ì´ ìˆëŠ”ì§€ í™•ì¸
docker exec ai_vibe_redis_dev redis-cli KEYS "turn_logs:${session}:3"
# ìˆìŒ â†’ Redis ì €ì¥ ì„±ê³µ
# ì—†ìŒ â†’ ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ì‹¤íŒ¨ ë˜ëŠ” ë¯¸ì™„ë£Œ

# 2. Turn 3 ë¡œê·¸ ë‚´ìš© í™•ì¸
docker exec ai_vibe_redis_dev redis-cli GET "turn_logs:${session}:3"
# score í•„ë“œ í™•ì¸

# 3. graph_state í™•ì¸
docker exec ai_vibe_redis_dev redis-cli GET "graph_state:${session}" | ConvertFrom-Json | Select-Object turn_scores

# 4. ì„œë²„ ë¡œê·¸ì—ì„œ 4ë²ˆ ê°€ë“œ ë¡œê·¸ í™•ì¸
Get-Content 10.txt | Select-String "$session.*Eval Turn Guard"
# "ì™„ë£Œ - turn_scores: {...}" í™•ì¸
```

---

### 4.10 Python ìŠ¤í¬ë¦½íŠ¸ë¡œ Redis ì¡°íšŒ

```python
# redis_check.py
import asyncio
import redis.asyncio as redis
import json

async def check_session(session_id):
    r = await redis.Redis(host='localhost', port=6379, db=0, decode_responses=True)
    
    # ê·¸ë˜í”„ ìƒíƒœ
    state = await r.get(f"graph_state:{session_id}")
    if state:
        print("=== Graph State ===")
        print(json.dumps(json.loads(state), indent=2, ensure_ascii=False))
    
    # í„´ ë¡œê·¸
    print("\n=== Turn Logs ===")
    async for key in r.scan_iter(f"turn_logs:{session_id}:*"):
        turn_num = key.split(":")[-1]
        log = await r.get(key)
        log_data = json.loads(log)
        print(f"\nTurn {turn_num}:")
        print(f"  Intent: {log_data.get('prompt_evaluation_details', {}).get('intent')}")
        print(f"  Score: {log_data.get('prompt_evaluation_details', {}).get('score')}")
    
    # í„´ ë§¤í•‘
    mapping = await r.get(f"turn_mapping:{session_id}")
    if mapping:
        print("\n=== Turn Mapping ===")
        print(json.dumps(json.loads(mapping), indent=2))
    
    await r.aclose()

# ì‹¤í–‰
asyncio.run(check_session("submit-test-20251127-041843"))
```

**ì‹¤í–‰:**
```bash
cd C:\P_project\LangGraph_1
uv run python redis_check.py
```

================================================================================
## 5. PostgreSQL ë°ì´í„° í™•ì¸ ë°©ë²•
================================================================================

### 5.1 PostgreSQL ì ‘ì†

```bash
# psql ì ‘ì†
docker exec -it ai_vibe_postgres_dev psql -U ai_vibe_user -d ai_vibe_db

# ë˜ëŠ” ë¡œì»¬ psql (ì„¤ì¹˜ëœ ê²½ìš°)
psql -h localhost -p 5435 -U ai_vibe_user -d ai_vibe_db
# ë¹„ë°€ë²ˆí˜¸: ai_vibe_password
```

---

### 5.2 í…Œì´ë¸” êµ¬ì¡° í™•ì¸

```sql
-- ëª¨ë“  í…Œì´ë¸” ëª©ë¡
\dt

-- ì˜ˆìƒ ì¶œë ¥:
-- exams
-- exam_specs
-- participants
-- exam_participations
-- submissions
-- evaluation_results

-- íŠ¹ì • í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ
\d exams
\d exam_specs
\d submissions
\d evaluation_results

-- ì»¬ëŸ¼ ìƒì„¸ ì •ë³´
\d+ evaluation_results
```

---

### 5.3 ë°ì´í„° ì¡°íšŒ

#### ì‹œí—˜ ë°ì´í„°
```sql
-- ëª¨ë“  ì‹œí—˜ ëª©ë¡
SELECT * FROM exams;

-- íŠ¹ì • ì‹œí—˜ì˜ ìŠ¤í™
SELECT * FROM exam_specs WHERE exam_id = 1;

-- ì‹œí—˜ + ìŠ¤í™ JOIN
SELECT 
    e.exam_id,
    e.title,
    es.spec_id,
    es.problem_title,
    es.difficulty
FROM exams e
JOIN exam_specs es ON e.exam_id = es.exam_id;
```

#### ì°¸ê°€ì ë°ì´í„°
```sql
-- ëª¨ë“  ì°¸ê°€ì
SELECT * FROM participants;

-- íŠ¹ì • ì‹œí—˜ì˜ ì°¸ê°€ì
SELECT 
    p.participant_id,
    p.name,
    ep.status,
    ep.started_at
FROM participants p
JOIN exam_participations ep ON p.participant_id = ep.participant_id
WHERE ep.exam_id = 1;
```

#### ì œì¶œ ë°ì´í„°
```sql
-- ëª¨ë“  ì œì¶œ
SELECT * FROM submissions ORDER BY submitted_at DESC LIMIT 10;

-- íŠ¹ì • ì„¸ì…˜ì˜ ì œì¶œ
SELECT * FROM submissions WHERE session_id = 'submit-test-20251127-041843';

-- ì œì¶œ + í‰ê°€ ê²°ê³¼ JOIN
SELECT 
    s.submission_id,
    s.session_id,
    s.code_content,
    s.submitted_at,
    er.total_score,
    er.grade
FROM submissions s
LEFT JOIN evaluation_results er ON s.submission_id = er.submission_id
ORDER BY s.submitted_at DESC;
```

#### í‰ê°€ ê²°ê³¼
```sql
-- ìµœê·¼ í‰ê°€ ê²°ê³¼
SELECT * FROM evaluation_results ORDER BY evaluated_at DESC LIMIT 10;

-- íŠ¹ì • ì°¸ê°€ìì˜ ì ìˆ˜
SELECT 
    er.participant_id,
    er.total_score,
    er.grade,
    er.prompt_score,
    er.performance_score,
    er.correctness_score
FROM evaluation_results er
WHERE er.participant_id = 100;
```

---

### 5.4 ì‹¤ì „ ì¿¼ë¦¬ ì˜ˆì‹œ

#### ì„¸ì…˜ë³„ ì ìˆ˜ ì¶”ì 
```sql
-- ì„¸ì…˜ì˜ ì œì¶œ ë° ì ìˆ˜
SELECT 
    s.session_id,
    s.submitted_at,
    er.total_score,
    er.grade,
    er.turn_scores::text,  -- JSONBë¥¼ TEXTë¡œ
    er.final_scores::text
FROM submissions s
LEFT JOIN evaluation_results er ON s.submission_id = er.submission_id
WHERE s.session_id LIKE 'submit-test-%'
ORDER BY s.submitted_at DESC;
```

#### í‰ê°€ í†µê³„
```sql
-- ë“±ê¸‰ë³„ ë¶„í¬
SELECT 
    grade,
    COUNT(*) as count,
    AVG(total_score) as avg_score
FROM evaluation_results
GROUP BY grade
ORDER BY grade;

-- ì ìˆ˜ ë¶„í¬
SELECT 
    CASE 
        WHEN total_score >= 90 THEN 'A (90-100)'
        WHEN total_score >= 80 THEN 'B (80-89)'
        WHEN total_score >= 70 THEN 'C (70-79)'
        WHEN total_score >= 60 THEN 'D (60-69)'
        ELSE 'F (<60)'
    END as score_range,
    COUNT(*) as count
FROM evaluation_results
GROUP BY score_range;
```

---

### 5.5 PowerShellì—ì„œ PostgreSQL ì¡°íšŒ

```powershell
# ê°„ë‹¨í•œ ì¿¼ë¦¬
docker exec ai_vibe_postgres_dev psql -U ai_vibe_user -d ai_vibe_db -c "SELECT * FROM exams;"

# ê²°ê³¼ë¥¼ íŒŒì¼ë¡œ ì €ì¥
docker exec ai_vibe_postgres_dev psql -U ai_vibe_user -d ai_vibe_db -c "SELECT * FROM submissions;" > submissions.txt

# CSVë¡œ ë‚´ë³´ë‚´ê¸°
docker exec ai_vibe_postgres_dev psql -U ai_vibe_user -d ai_vibe_db -c "COPY (SELECT * FROM evaluation_results) TO STDOUT CSV HEADER;" > results.csv
```

================================================================================
## 6. ì¼ë°˜ì ì¸ ë¬¸ì œ í•´ê²° ë°©ë²•
================================================================================

### 6.1 "ì„œë²„ ì‘ë‹µì´ ì—†ì–´ìš”"

#### ì²´í¬ë¦¬ìŠ¤íŠ¸:
```bash
# 1. ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ê°€?
netstat -ano | findstr ":8000"

# 2. Docker ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ ì¤‘ì¸ê°€?
docker ps --filter "name=ai_vibe"

# 3. ì„œë²„ ë¡œê·¸ì— ì—ëŸ¬ê°€ ìˆëŠ”ê°€?
Get-Content <terminals-path>\<ì„œë²„-í„°ë¯¸ë„>.txt -Tail 50 | Select-String "ERROR"

# 4. ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
curl http://localhost:8000/health
# ë˜ëŠ”
Invoke-WebRequest http://localhost:8000/health
```

---

### 6.2 "íƒ€ì„ì•„ì›ƒì´ ë°œìƒí•´ìš”"

#### ì›ì¸ í™•ì¸:
```powershell
# 1. ì„œë²„ ë¡œê·¸ì—ì„œ ìš”ì²­ ê¸°ë¡ í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "session_id: <your-session>"

# 2. íŠ¹ì • ë…¸ë“œì—ì„œ ë©ˆì·„ëŠ”ì§€ í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "<session>.*ì§„ì…|ì™„ë£Œ"

# 3. LLM API ì—ëŸ¬ í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "429|rate|quota"
```

#### í•´ê²°:
- Gemini API Quota í™•ì¸: https://ai.dev/usage
- íƒ€ì„ì•„ì›ƒ ì„¤ì • ì¦ê°€: `chat.py`ì—ì„œ `asyncio.wait_for(timeout=180)`
- LLM í˜¸ì¶œ ìµœì†Œí™”

---

### 6.3 "turn_scoresì— ì¼ë¶€ í„´ë§Œ ìˆì–´ìš”"

#### ë””ë²„ê¹… ìˆœì„œ:
```powershell
$session = "<your-session-id>"

# 1. Redis turn_logs í™•ì¸
docker exec ai_vibe_redis_dev redis-cli KEYS "turn_logs:${session}:*"

# 2. ê° í„´ ë¡œê·¸ì˜ ì ìˆ˜ í™•ì¸
docker exec ai_vibe_redis_dev redis-cli GET "turn_logs:${session}:1"
# "score" í•„ë“œ í™•ì¸

# 3. turn_mapping í™•ì¸
docker exec ai_vibe_redis_dev redis-cli GET "turn_mapping:${session}"

# 4. ì„œë²„ ë¡œê·¸ì—ì„œ 4ë²ˆ ê°€ë“œ ë¡œê·¸ í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "$session.*Eval Turn Guard"
# "ì™„ë£Œ - turn_scores: {...}" ì¶œë ¥ í™•ì¸

# 5. ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ì™„ë£Œ ì—¬ë¶€ í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "$session.*4ë²ˆ ë…¸ë“œ ë°±ê·¸ë¼ìš´ë“œ.*ì™„ë£Œ"
```

---

### 6.4 "Redis ì—°ê²° ì—ëŸ¬"

#### í™•ì¸ ë° í•´ê²°:
```bash
# 1. Redis ì»¨í…Œì´ë„ˆ ìƒíƒœ
docker ps --filter "name=redis"

# 2. Redis í•‘ í…ŒìŠ¤íŠ¸
docker exec ai_vibe_redis_dev redis-cli PING
# ì˜ˆìƒ: PONG

# 3. Redis ì¬ì‹œì‘
docker restart ai_vibe_redis_dev

# 4. Redis ë¡œê·¸ í™•ì¸
docker logs ai_vibe_redis_dev --tail 50
```

---

### 6.5 "PostgreSQL ì—°ê²° ì—ëŸ¬"

#### í™•ì¸ ë° í•´ê²°:
```bash
# 1. PostgreSQL ì»¨í…Œì´ë„ˆ ìƒíƒœ
docker ps --filter "name=postgres"

# 2. PostgreSQL ì—°ê²° í…ŒìŠ¤íŠ¸
docker exec ai_vibe_postgres_dev pg_isready -U ai_vibe_user
# ì˜ˆìƒ: accepting connections

# 3. PostgreSQL ì¬ì‹œì‘
docker restart ai_vibe_postgres_dev

# 4. ë¡œê·¸ í™•ì¸
docker logs ai_vibe_postgres_dev --tail 50 | findstr "ERROR"
```

---

### 6.6 "ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ê°€ ì™„ë£Œ ì•ˆ ë¼ìš”"

#### í™•ì¸:
```powershell
$session = "<your-session-id>"

# 1. ì„œë²„ ë¡œê·¸ì—ì„œ ë°±ê·¸ë¼ìš´ë“œ ì‹œì‘ í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "$session.*ë°±ê·¸ë¼ìš´ë“œ.*ì‹œì‘"

# 2. ì™„ë£Œ í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "$session.*ë°±ê·¸ë¼ìš´ë“œ.*ì™„ë£Œ"

# 3. ì—ëŸ¬ í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "$session.*ë°±ê·¸ë¼ìš´ë“œ" | Select-String "ERROR|Exception"

# 4. Redis turn_logs í™•ì¸
docker exec ai_vibe_redis_dev redis-cli KEYS "turn_logs:${session}:*"

# 5. 4ë²ˆ ì„œë¸Œê·¸ë˜í”„ ë¡œê·¸ í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "$session.*4\."
```

================================================================================
## 7. ë¡œê·¸ ì¶”ì  ì‹¤ì „ ì˜ˆì‹œ
================================================================================

### 7.1 ì „ì²´ í”Œë¡œìš° ì¶”ì  (Step by Step)

#### Step 1: ì„¸ì…˜ ID íŒŒì•…
```powershell
# í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì¶œë ¥ì—ì„œ
# Session: submit-test-20251127-041843
$session = "submit-test-20251127-041843"
```

#### Step 2: ì„œë²„ í„°ë¯¸ë„ íŒŒì¼ ì°¾ê¸°
```powershell
cd C:\Users\YSH\.cursor\projects\c-Users-YSH-AppData-Roaming-Cursor-Workspaces-1762325051351-workspace-json\terminals

# ìµœê·¼ íŒŒì¼ í™•ì¸
Get-ChildItem | Sort-Object LastWriteTime -Descending | Select-Object -First 3

# ì„œë²„ ë¡œê·¸ íŒŒì¼ í™•ì¸ (active_commandì— run_dev.py ìˆëŠ” íŒŒì¼)
Get-Content 10.txt | Select-Object -First 10
```

#### Step 3: ë…¸ë“œë³„ í”Œë¡œìš° ì¶”ì 
```powershell
# 1ë²ˆ ë…¸ë“œ
Get-Content 10.txt | Select-String "$session.*\[1\. Handle Request\]"

# 2ë²ˆ ë…¸ë“œ
Get-Content 10.txt | Select-String "$session.*\[.*Intent Analyzer\]"

# 3ë²ˆ ë…¸ë“œ
Get-Content 10.txt | Select-String "$session.*\[.*Writer LLM\]"

# 4ë²ˆ ê°€ë“œ
Get-Content 10.txt | Select-String "$session.*\[4\. Eval Turn Guard\]"

# 6a-7ë²ˆ ë…¸ë“œ
Get-Content 10.txt | Select-String "$session.*\[6.*\]|\[7\. Aggregate\]"
```

#### Step 4: ê° í„´ë³„ ì¶”ì 
```powershell
# Turn 1 ì „ì²´ í”Œë¡œìš°
Get-Content 10.txt | Select-String "$session" | Select-String "turn.*: 1"

# Turn 1 ë°±ê·¸ë¼ìš´ë“œ í‰ê°€
Get-Content 10.txt | Select-String "$session.*turn: 1.*4\."
```

#### Step 5: Redis ë°ì´í„° ê²€ì¦
```bash
# turn_logs ëª¨ë‘ ìˆëŠ”ì§€
docker exec ai_vibe_redis_dev redis-cli KEYS "turn_logs:${session}:*"

# ê° í„´ ì ìˆ˜ í™•ì¸
docker exec ai_vibe_redis_dev redis-cli GET "turn_logs:${session}:1" | ConvertFrom-Json | Select-Object -ExpandProperty prompt_evaluation_details
```

#### Step 6: ìµœì¢… ê²°ê³¼ í™•ì¸
```powershell
# graph_stateì˜ turn_scores
docker exec ai_vibe_redis_dev redis-cli GET "graph_state:$session" | ConvertFrom-Json | Select-Object turn_scores, final_scores
```

---

### 7.2 ì—ëŸ¬ ì¶”ì  ì˜ˆì‹œ

#### ì‹œë‚˜ë¦¬ì˜¤: "Turn 2ì—ì„œ íƒ€ì„ì•„ì›ƒ"

```powershell
$session = "submit-test-20251127-042442"

# 1. Turn 2 ì‹œì‘ ì‹œì 
Get-Content 10.txt | Select-String "$session.*Turn 2|turn: 2" | Select-Object -First 5

# ì¶œë ¥ ì˜ˆì‹œ:
# 04:25:08 - [Intent Analyzer] ë¶„ì„ ì‹œì‘
# 04:25:11 - [Writer LLM] ë‹µë³€ ìƒì„± ì‹œì‘

# 2. Turn 2ì—ì„œ ë©ˆì¶˜ ë…¸ë“œ ì°¾ê¸°
Get-Content 10.txt | Select-String "$session.*turn: 2" | Select-String "ì§„ì…|ì‹œì‘"
Get-Content 10.txt | Select-String "$session.*turn: 2" | Select-String "ì™„ë£Œ|ì¢…ë£Œ"

# ì§„ì…ì€ ìˆëŠ”ë° ì™„ë£Œê°€ ì—†ëŠ” ë…¸ë“œ â†’ ë©ˆì¶˜ ë…¸ë“œ!

# 3. í•´ë‹¹ ë…¸ë“œì˜ ì—ëŸ¬ ë¡œê·¸
Get-Content 10.txt | Select-String "$session.*turn: 2" | Select-String "ERROR|Exception"

# ì¶œë ¥ ì˜ˆì‹œ:
# 04:26:22 - [4.X ë‹µë³€ ìš”ì•½] ì˜¤ë¥˜ - error: 429 You exceeded your current quota

# 4. ì›ì¸: Gemini API Quota ì´ˆê³¼!
```

---

### 7.3 ì„±ëŠ¥ ì¶”ì  ì˜ˆì‹œ

#### ê° ë…¸ë“œ ì†Œìš” ì‹œê°„ ì¸¡ì •

```powershell
$session = "submit-test-20251127-041843"

# Writer LLM ì‹œê°„
$logs = Get-Content 10.txt | Select-String "$session.*Writer LLM"
$start = $logs | Select-String "ì‹œì‘" | Select-Object -First 1
$end = $logs | Select-String "ì„±ê³µ|ì™„ë£Œ" | Select-Object -First 1

# íƒ€ì„ìŠ¤íƒ¬í”„ ì¶”ì¶œ (ìˆ˜ë™)
# 04:18:49 â†’ 04:18:54 = 5ì´ˆ

# 6a Holistic Flow ì‹œê°„
Get-Content 10.txt | Select-String "$session.*6a.*Holistic" | Select-String "ì§„ì…|ì™„ë£Œ"

# ì „ì²´ ì œì¶œ í”Œë¡œìš° ì‹œê°„
Get-Content 10.txt | Select-String "$session.*ì½”ë“œ ì œì¶œ ìˆ˜ì‹ "
Get-Content 10.txt | Select-String "$session.*LangGraph ì‹¤í–‰ ì™„ë£Œ"
# íƒ€ì„ìŠ¤íƒ¬í”„ ì°¨ì´ ê³„ì‚°
```

================================================================================
## 8. ë¹ ë¥¸ ì°¸ì¡° (Cheat Sheet)
================================================================================

### 8.1 ìì£¼ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´

#### ì„œë²„ ê´€ë¦¬
```bash
# ì„œë²„ ì‹œì‘
cd C:\P_project\LangGraph_1
uv run scripts/run_dev.py

# ì„œë²„ ì¤‘ë‹¨ (Ctrl+C ë˜ëŠ”)
Get-Process | Where-Object { $_.ProcessName -like "*python*" } | Stop-Process -Force

# ì„œë²„ í¬íŠ¸ í™•ì¸
netstat -ano | findstr ":8000"
```

#### Docker ê´€ë¦¬
```bash
# ì»¨í…Œì´ë„ˆ ìƒíƒœ
docker ps --filter "name=ai_vibe"

# ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
docker restart ai_vibe_redis_dev ai_vibe_postgres_dev

# ë¡œê·¸ ë³´ê¸°
docker logs ai_vibe_redis_dev --tail 50
docker logs ai_vibe_postgres_dev --tail 50
```

#### Redis ì¡°íšŒ
```bash
# Redis CLI ì ‘ì†
docker exec -it ai_vibe_redis_dev redis-cli

# í‚¤ ì¡°íšŒ
docker exec ai_vibe_redis_dev redis-cli KEYS "turn_logs:*"
docker exec ai_vibe_redis_dev redis-cli KEYS "graph_state:*"
docker exec ai_vibe_redis_dev redis-cli KEYS "turn_mapping:*"

# ë°ì´í„° ì¡°íšŒ
docker exec ai_vibe_redis_dev redis-cli GET "turn_logs:<session>:<turn>"

# ë°ì´í„° ì‚­ì œ (ê°œë°œ í™˜ê²½)
docker exec ai_vibe_redis_dev redis-cli FLUSHALL
```

#### PostgreSQL ì¡°íšŒ
```bash
# psql ì ‘ì†
docker exec -it ai_vibe_postgres_dev psql -U ai_vibe_user -d ai_vibe_db

# ì¿¼ë¦¬ ì‹¤í–‰
docker exec ai_vibe_postgres_dev psql -U ai_vibe_user -d ai_vibe_db -c "SELECT * FROM submissions;"
```

---

### 8.2 ë¡œê·¸ ê²€ìƒ‰ íŒ¨í„´

```powershell
# íŠ¹ì • ì„¸ì…˜ ëª¨ë“  ë¡œê·¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "session_id: <session>"

# ì—ëŸ¬ë§Œ
Get-Content <í„°ë¯¸ë„>.txt | Select-String "ERROR|Exception|Failed"

# íŠ¹ì • ë…¸ë“œ
Get-Content <í„°ë¯¸ë„>.txt | Select-String "Eval Turn Guard|Writer LLM"

# ì»¨í…ìŠ¤íŠ¸ í¬í•¨ (ì „í›„ 3ì¤„)
Get-Content <í„°ë¯¸ë„>.txt | Select-String "í‚¤ì›Œë“œ" -Context 3,3

# ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
Get-Content <í„°ë¯¸ë„>.txt -Wait -Tail 20
```

---

### 8.3 Redis í‚¤ êµ¬ì¡° ë¹ ë¥¸ ì°¸ì¡°

```
graph_state:{session_id}
  â†’ ì„¸ì…˜ ì „ì²´ ìƒíƒœ
  â†’ current_turn, messages, turn_scores, final_scores ë“±

turn_logs:{session_id}:{turn}
  â†’ ê° í„´ì˜ í‰ê°€ ë¡œê·¸
  â†’ intent, score, rubrics, reasoning

turn_mapping:{session_id}
  â†’ í„´-ë©”ì‹œì§€ ì¸ë±ìŠ¤ ë§¤í•‘
  â†’ {"1": {"start_msg_idx": 0, "end_msg_idx": 1}, ...}

eval:scores:{session_id}
  â†’ ìµœì¢… ì ìˆ˜ ì €ì¥
  â†’ turns, final

memory:summary:{session_id}
  â†’ ë©”ëª¨ë¦¬ ìš”ì•½
```

---

### 8.4 ë¬¸ì œë³„ ë¹ ë¥¸ í•´ê²°

| ë¬¸ì œ | í™•ì¸ ëª…ë ¹ | í•´ê²° |
|------|-----------|------|
| ì„œë²„ ì•ˆ ì—´ë¦¼ | `netstat -ano \| findstr ":8000"` | í¬íŠ¸ ì‚¬ìš© í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ |
| Redis ì—°ê²° ì‹¤íŒ¨ | `docker exec ai_vibe_redis_dev redis-cli PING` | `docker restart ai_vibe_redis_dev` |
| PostgreSQL ì—°ê²° ì‹¤íŒ¨ | `docker exec ai_vibe_postgres_dev pg_isready` | `docker restart ai_vibe_postgres_dev` |
| íƒ€ì„ì•„ì›ƒ | ì„œë²„ ë¡œê·¸ì—ì„œ ë©ˆì¶˜ ë…¸ë“œ í™•ì¸ | LLM API Quota í™•ì¸ |
| turn_scores ëˆ„ë½ | `KEYS turn_logs:*` í™•ì¸ | ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ëŒ€ê¸° ì‹œê°„ ì¦ê°€ |

================================================================================
## 9. ì™„ì „í•œ í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ (ì²˜ìŒë¶€í„° ëê¹Œì§€)
================================================================================

### 9.1 í™˜ê²½ ì¤€ë¹„

```powershell
# 1. Docker ì»¨í…Œì´ë„ˆ ì‹œì‘
cd C:\P_project\LangGraph_1
docker-compose -f docker-compose.dev.yml up -d

# 2. ìƒíƒœ í™•ì¸
docker ps --filter "name=ai_vibe"
# Redis, PostgreSQL ëª¨ë‘ healthy í™•ì¸

# 3. FastAPI ì„œë²„ ì‹œì‘ (ë³„ë„ í„°ë¯¸ë„)
cd C:\P_project\LangGraph_1
uv run scripts/run_dev.py

# 4. ì„œë²„ ì •ìƒ ì‹œì‘ ëŒ€ê¸° (5ì´ˆ)

# 5. í—¬ìŠ¤ ì²´í¬
curl http://localhost:8000/health
# ì˜ˆìƒ: {"status":"ok"}
```

---

### 9.2 í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```powershell
# ìƒˆ í„°ë¯¸ë„ ì—´ê¸°
cd C:\P_project\LangGraph_1
chcp 65001  # UTF-8 ì¸ì½”ë”©

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
uv run python test_submit_with_delay.py

# ì¶œë ¥ ì˜ˆì‹œ:
# Session: submit-test-20251127-041843
# [Turn 1] í”¼ë³´ë‚˜ì¹˜ í•¨ìˆ˜ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”...
#   [OK] AI ì‘ë‹µ: 795ì
# ...
```

---

### 9.3 ê²°ê³¼ í™•ì¸

#### A. í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì¶œë ¥ í™•ì¸
```json
{
  "is_submitted": true,
  "turn_scores": {
    "1": 85.5,
    "2": 92.0,
    "3": 78.3
  },
  "final_scores": {
    "total_score": 64.25,
    "grade": "D"
  }
}
```

#### B. ì„œë²„ ë¡œê·¸ í™•ì¸
```powershell
# í„°ë¯¸ë„ í´ë”ë¡œ ì´ë™
cd C:\Users\YSH\.cursor\projects\c-Users-YSH-AppData-Roaming-Cursor-Workspaces-1762325051351-workspace-json\terminals

# ìµœê·¼ í„°ë¯¸ë„ íŒŒì¼ í™•ì¸
Get-ChildItem | Sort-Object LastWriteTime -Descending | Select-Object -First 1
# ì˜ˆ: 10.txt

# í•´ë‹¹ ì„¸ì…˜ ë¡œê·¸ë§Œ ë³´ê¸°
$session = "submit-test-20251127-041843"
Get-Content 10.txt | Select-String $session | Out-File -FilePath "C:\P_project\LangGraph_1\test_log_$session.txt"

# ë¡œê·¸ íŒŒì¼ ì—´ì–´ì„œ í™•ì¸
notepad "C:\P_project\LangGraph_1\test_log_$session.txt"
```

#### C. Redis ë°ì´í„° í™•ì¸
```bash
# Redis CLI ì ‘ì†
docker exec -it ai_vibe_redis_dev redis-cli

# ì„¸ì…˜ì˜ ëª¨ë“  í‚¤ í™•ì¸
KEYS *submit-test-20251127-041843*

# ì˜ˆìƒ ì¶œë ¥:
# graph_state:submit-test-20251127-041843
# turn_logs:submit-test-20251127-041843:1
# turn_logs:submit-test-20251127-041843:2
# turn_logs:submit-test-20251127-041843:3
# turn_mapping:submit-test-20251127-041843

# í„´ ë§¤í•‘ í™•ì¸
GET turn_mapping:submit-test-20251127-041843

# í„´ ë¡œê·¸ í™•ì¸
GET turn_logs:submit-test-20251127-041843:1
GET turn_logs:submit-test-20251127-041843:2
GET turn_logs:submit-test-20251127-041843:3

# ìµœì¢… ìƒíƒœ í™•ì¸
GET graph_state:submit-test-20251127-041843
# turn_scores í•„ë“œ í™•ì¸

# ì¢…ë£Œ
exit
```

#### D. PostgreSQL ë°ì´í„° í™•ì¸ (ì œì¶œ ê¸°ë¡)
```bash
# psql ì ‘ì†
docker exec -it ai_vibe_postgres_dev psql -U ai_vibe_user -d ai_vibe_db

# ì œì¶œ ê¸°ë¡ í™•ì¸
SELECT * FROM submissions WHERE session_id = 'submit-test-20251127-041843';

# í‰ê°€ ê²°ê³¼ í™•ì¸
SELECT * FROM evaluation_results 
WHERE submission_id = (
    SELECT submission_id FROM submissions 
    WHERE session_id = 'submit-test-20251127-041843'
);

# ì¢…ë£Œ
\q
```

---

### 9.4 ë¬¸ì œ ë°œê²¬ ì‹œ ë””ë²„ê¹…

#### ë¬¸ì œ: "turn_scoresì— Turn 3ì´ ì—†ì–´ìš”"

```powershell
$session = "submit-test-20251127-041843"

# [1ë‹¨ê³„] Redisì— Turn 3 ë¡œê·¸ê°€ ìˆëŠ”ì§€ í™•ì¸
docker exec ai_vibe_redis_dev redis-cli EXISTS "turn_logs:${session}:3"
# 1 â†’ ìˆìŒ
# 0 â†’ ì—†ìŒ (ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ì‹¤íŒ¨)

# [2ë‹¨ê³„] ìˆë‹¤ë©´ ë‚´ìš© í™•ì¸
docker exec ai_vibe_redis_dev redis-cli GET "turn_logs:${session}:3"
# score í•„ë“œê°€ ìˆëŠ”ì§€ í™•ì¸

# [3ë‹¨ê³„] ì„œë²„ ë¡œê·¸ì—ì„œ 4ë²ˆ ê°€ë“œ ë¡œê·¸ í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "$session.*Eval Turn Guard"

# ì¶œë ¥ ì˜ˆì‹œ:
# [4. Eval Turn Guard] ì§„ì… - í˜„ì¬ í„´: 4
# [4. Eval Turn Guard] ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ì™„ë£Œ ëŒ€ê¸° ì‹œì‘
# [4. Eval Turn Guard] ëª¨ë“  ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ì™„ë£Œ - ëŒ€ê¸° ì‹œê°„: 1.5ì´ˆ
# [4. Eval Turn Guard] Redis í„´ ë¡œê·¸ ê°œìˆ˜: 3
# [4. Eval Turn Guard] ì™„ë£Œ - turn_scores: {'1': 85.5, '2': 92.0, '3': 78.3}

# [4ë‹¨ê³„] turn_scores ë³€í™˜ ë¡œì§ í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "$session.*turn_scores"

# [5ë‹¨ê³„] 6b ë…¸ë“œì—ì„œ ë°›ì€ turn_scores í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "$session.*6b.*Aggregate Turn"
```

---

### 9.5 ë¡œê·¸ ì €ì¥ ë° ê³µìœ 

```powershell
$session = "submit-test-20251127-041843"
$output_dir = "C:\P_project\LangGraph_1\test_results"

# ì¶œë ¥ í´ë” ìƒì„±
New-Item -ItemType Directory -Force -Path $output_dir

# ì„œë²„ ë¡œê·¸ ì €ì¥
Get-Content <í„°ë¯¸ë„>.txt | Select-String $session > "$output_dir\server_log_$session.txt"

# Redis ë°ì´í„° ì €ì¥
docker exec ai_vibe_redis_dev redis-cli KEYS "*$session*" > "$output_dir\redis_keys_$session.txt"

# ê° í„´ ë¡œê·¸ ì €ì¥
for ($i=1; $i -le 3; $i++) {
    docker exec ai_vibe_redis_dev redis-cli GET "turn_logs:${session}:$i" | ConvertFrom-Json | ConvertTo-Json -Depth 10 > "$output_dir\turn_${i}_log.json"
}

# í„´ ë§¤í•‘ ì €ì¥
docker exec ai_vibe_redis_dev redis-cli GET "turn_mapping:$session" > "$output_dir\turn_mapping.json"

# ìµœì¢… ìƒíƒœ ì €ì¥
docker exec ai_vibe_redis_dev redis-cli GET "graph_state:$session" | ConvertFrom-Json | ConvertTo-Json -Depth 10 > "$output_dir\final_state.json"
```

================================================================================
## 10. ê³ ê¸‰ ë””ë²„ê¹… ê¸°ë²•
================================================================================

### 10.1 í„´ë³„ í‰ê°€ ìƒì„¸ ì¶”ì 

```python
# debug_turn_evaluation.py
import asyncio
import redis.asyncio as redis
import json

async def debug_turn(session_id, turn):
    r = await redis.Redis(host='localhost', port=6379, db=0, decode_responses=True)
    
    print(f"=== Turn {turn} ë””ë²„ê¹… ===\n")
    
    # 1. turn_log í™•ì¸
    log_key = f"turn_logs:{session_id}:{turn}"
    log = await r.get(log_key)
    
    if log:
        log_data = json.loads(log)
        print(f"âœ… turn_log ì¡´ì¬")
        print(f"  Intent: {log_data.get('prompt_evaluation_details', {}).get('intent')}")
        print(f"  Score: {log_data.get('prompt_evaluation_details', {}).get('score')}")
        print(f"  Rubrics: {len(log_data.get('prompt_evaluation_details', {}).get('rubrics', []))}ê°œ")
    else:
        print(f"âŒ turn_log ì—†ìŒ - ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ë¯¸ì™„ë£Œ")
    
    # 2. turn_mapping í™•ì¸
    mapping_key = f"turn_mapping:{session_id}"
    mapping = await r.get(mapping_key)
    
    if mapping:
        mapping_data = json.loads(mapping)
        if str(turn) in mapping_data:
            print(f"âœ… turn_mapping ì¡´ì¬")
            print(f"  Indices: {mapping_data[str(turn)]}")
        else:
            print(f"âŒ turn {turn} ë§¤í•‘ ì—†ìŒ")
    else:
        print(f"âŒ turn_mapping ì „ì²´ ì—†ìŒ")
    
    # 3. graph_stateì˜ turn_scores í™•ì¸
    state_key = f"graph_state:{session_id}"
    state = await r.get(state_key)
    
    if state:
        state_data = json.loads(state)
        turn_scores = state_data.get('turn_scores', {})
        if str(turn) in turn_scores:
            print(f"âœ… turn_scoresì— í¬í•¨")
            print(f"  Score: {turn_scores[str(turn)]}")
        else:
            print(f"âŒ turn_scoresì— ì—†ìŒ")
    
    await r.aclose()

# ì‹¤í–‰
session = "submit-test-20251127-041843"
for turn in [1, 2, 3]:
    asyncio.run(debug_turn(session, turn))
    print()
```

**ì‹¤í–‰:**
```bash
cd C:\P_project\LangGraph_1
uv run python debug_turn_evaluation.py
```

---

### 10.2 ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ì™„ë£Œ ëŒ€ê¸° í™•ì¸

```python
# check_background_completion.py
import asyncio
import redis.asyncio as redis

async def wait_for_turn(session_id, turn, max_wait=10):
    r = await redis.Redis(host='localhost', port=6379, db=0, decode_responses=True)
    
    print(f"Turn {turn} ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ëŒ€ê¸° ì¤‘...")
    waited = 0
    
    while waited < max_wait:
        key = f"turn_logs:{session_id}:{turn}"
        exists = await r.exists(key)
        
        if exists:
            print(f"âœ… Turn {turn} í‰ê°€ ì™„ë£Œ! (ëŒ€ê¸° ì‹œê°„: {waited}ì´ˆ)")
            return True
        
        await asyncio.sleep(0.5)
        waited += 0.5
    
    print(f"âŒ Turn {turn} í‰ê°€ íƒ€ì„ì•„ì›ƒ ({max_wait}ì´ˆ)")
    return False

# ì‚¬ìš©
session = "submit-test-20251127-041843"
asyncio.run(wait_for_turn(session, 3))
```

---

### 10.3 LLM í˜¸ì¶œ íšŸìˆ˜ ì¹´ìš´íŠ¸

```powershell
$session = "submit-test-20251127-041843"

# Intent Analyzer í˜¸ì¶œ
$intent_count = (Get-Content <í„°ë¯¸ë„>.txt | Select-String "$session.*Intent Analyzer.*ë¶„ì„ ì‹œì‘").Count
Write-Host "Intent Analyzer: $intent_count íšŒ"

# Writer LLM í˜¸ì¶œ
$writer_count = (Get-Content <í„°ë¯¸ë„>.txt | Select-String "$session.*Writer LLM.*ë‹µë³€ ìƒì„± ì‹œì‘").Count
Write-Host "Writer LLM: $writer_count íšŒ"

# 4ë²ˆ í‰ê°€ ë…¸ë“œ í˜¸ì¶œ
$eval_count = (Get-Content <í„°ë¯¸ë„>.txt | Select-String "$session.*4\..*í‰ê°€.*ì‹œì‘").Count
Write-Host "í‰ê°€ ë…¸ë“œ: $eval_count íšŒ"

# ì´ LLM í˜¸ì¶œ
$total = $intent_count + $writer_count + $eval_count
Write-Host "ì´ LLM í˜¸ì¶œ: $total íšŒ"
Write-Host "ì˜ˆìƒ Quota ì†Œëª¨: ì•½ $($total * 1000) í† í° (ì‘ë‹µ ì œì™¸)"
```

---

### 10.4 ì „ì²´ í”Œë¡œìš° ì‹œê°í™” ìŠ¤í¬ë¦½íŠ¸

```python
# visualize_flow.py
import asyncio
import redis.asyncio as redis
import json
from datetime import datetime

async def visualize_session_flow(session_id):
    r = await redis.Redis(host='localhost', port=6379, db=0, decode_responses=True)
    
    print(f"{'='*80}")
    print(f"Session Flow Visualization: {session_id}")
    print(f"{'='*80}\n")
    
    # 1. Graph State
    state_key = f"graph_state:{session_id}"
    state = await r.get(state_key)
    if state:
        state_data = json.loads(state)
        print(f"ğŸ“Š Current Turn: {state_data.get('current_turn')}")
        print(f"ğŸ“ Total Messages: {len(state_data.get('messages', []))}")
        print(f"âœ… Submitted: {state_data.get('is_submitted')}")
        print(f"ğŸ’¯ Final Score: {state_data.get('final_scores', {}).get('total_score')}")
    
    # 2. Turn Logs
    print(f"\n{'â”€'*80}")
    print("ğŸ“‹ Turn Evaluation Results:")
    print(f"{'â”€'*80}\n")
    
    async for key in r.scan_iter(f"turn_logs:{session_id}:*"):
        turn_num = key.split(":")[-1]
        log = await r.get(key)
        log_data = json.loads(log)
        
        details = log_data.get('prompt_evaluation_details', {})
        print(f"Turn {turn_num}:")
        print(f"  Intent: {details.get('intent')}")
        print(f"  Score: {details.get('score')}")
        print(f"  Rubrics: {len(details.get('rubrics', []))} ê°œ")
        
        # Guardrail ìœ„ë°˜ ì—¬ë¶€
        if log_data.get('is_guardrail_failed'):
            print(f"  âš ï¸ Guardrail: {log_data.get('guardrail_message')}")
        print()
    
    # 3. Turn Mapping
    mapping_key = f"turn_mapping:{session_id}"
    mapping = await r.get(mapping_key)
    if mapping:
        mapping_data = json.loads(mapping)
        print(f"{'â”€'*80}")
        print("ğŸ—ºï¸ Turn-Message Mapping:")
        print(f"{'â”€'*80}\n")
        for turn, indices in sorted(mapping_data.items()):
            print(f"Turn {turn}: messages[{indices['start_msg_idx']}:{indices['end_msg_idx']}]")
    
    await r.aclose()

# ì‹¤í–‰
if __name__ == "__main__":
    session = input("Session ID: ")
    asyncio.run(visualize_session_flow(session))
```

**ì‹¤í–‰:**
```bash
cd C:\P_project\LangGraph_1
uv run python visualize_flow.py
# Session ID: submit-test-20251127-041843
```

================================================================================
## 11. íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì²´í¬ë¦¬ìŠ¤íŠ¸
================================================================================

### ë¬¸ì œ: í…ŒìŠ¤íŠ¸ê°€ ì‹œì‘ë˜ì§€ ì•ŠìŒ

```
âœ… Docker ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì¤‘?
   â†’ docker ps --filter "name=ai_vibe"

âœ… FastAPI ì„œë²„ ì‹¤í–‰ ì¤‘?
   â†’ netstat -ano | findstr ":8000"

âœ… ì—”ë“œí¬ì¸íŠ¸ ì‘ë‹µí•˜ëŠ”ê°€?
   â†’ curl http://localhost:8000/health

âœ… Python ê°€ìƒí™˜ê²½ í™œì„±í™”ë¨?
   â†’ uv run python --version
```

---

### ë¬¸ì œ: ì‘ë‹µì´ ë„ˆë¬´ ëŠë¦¼

```
âœ… Gemini API Quota í™•ì¸
   â†’ https://ai.dev/usage

âœ… ì„œë²„ ë¡œê·¸ì—ì„œ ë©ˆì¶˜ ë…¸ë“œ í™•ì¸
   â†’ Get-Content <í„°ë¯¸ë„>.txt | Select-String "ì§„ì…" 
   â†’ Get-Content <í„°ë¯¸ë„>.txt | Select-String "ì™„ë£Œ"
   â†’ ì§„ì… ìˆê³  ì™„ë£Œ ì—†ìŒ â†’ í•´ë‹¹ ë…¸ë“œì—ì„œ ë©ˆì¶¤

âœ… LLM API ì—ëŸ¬ í™•ì¸
   â†’ Get-Content <í„°ë¯¸ë„>.txt | Select-String "429|rate|quota"

âœ… Redis/PostgreSQL ì—°ê²° í™•ì¸
   â†’ docker exec ai_vibe_redis_dev redis-cli PING
   â†’ docker exec ai_vibe_postgres_dev pg_isready
```

---

### ë¬¸ì œ: turn_scores ë°ì´í„° ë¶ˆì™„ì „

```
âœ… Redis turn_logs í™•ì¸
   â†’ docker exec ai_vibe_redis_dev redis-cli KEYS "turn_logs:<session>:*"
   â†’ ëª¨ë“  í„´ì´ ìˆëŠ”ê°€?

âœ… ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ì™„ë£Œ í™•ì¸
   â†’ Get-Content <í„°ë¯¸ë„>.txt | Select-String "ë°±ê·¸ë¼ìš´ë“œ.*ì™„ë£Œ"

âœ… 4ë²ˆ ê°€ë“œ ëŒ€ê¸° ë¡œê·¸ í™•ì¸
   â†’ Get-Content <í„°ë¯¸ë„>.txt | Select-String "ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ëŒ€ê¸°"
   â†’ Get-Content <í„°ë¯¸ë„>.txt | Select-String "ëª¨ë“  ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ì™„ë£Œ"

âœ… turn_scores ë³€í™˜ ë¡œê·¸ í™•ì¸
   â†’ Get-Content <í„°ë¯¸ë„>.txt | Select-String "ì™„ë£Œ - turn_scores:"
```

---

### ë¬¸ì œ: ê°€ë“œë ˆì¼ ê²½ê³  ë©”ì‹œì§€ê°€ ì•ˆ ë‚˜ì˜´

```
âœ… Intent Analyzer ë¡œê·¸ í™•ì¸
   â†’ Get-Content <í„°ë¯¸ë„>.txt | Select-String "guardrail_passed: False"

âœ… Writer LLMì´ ê°€ë“œë ˆì¼ ëª¨ë“œë¡œ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€
   â†’ Get-Content <í„°ë¯¸ë„>.txt | Select-String "guardrail_failed: True"

âœ… í„´ ë¡œê·¸ì— ê°€ë“œë ˆì¼ ì •ë³´ ìˆëŠ”ì§€
   â†’ docker exec ai_vibe_redis_dev redis-cli GET "turn_logs:<session>:<turn>"
   â†’ "is_guardrail_failed" í•„ë“œ í™•ì¸
```

================================================================================
## 12. ìœ ìš©í•œ PowerShell í•¨ìˆ˜
================================================================================

### 12.1 ìì£¼ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ ì •ì˜

```powershell
# PowerShell í”„ë¡œí•„ì— ì¶”ê°€ ($PROFILE)
# ë˜ëŠ” í…ŒìŠ¤íŠ¸ ì‹œì‘ ì „ ì‹¤í–‰

function Get-AIVibeLog {
    param(
        [string]$SessionId,
        [string]$Pattern = ""
    )
    
    $terminals = "C:\Users\YSH\.cursor\projects\c-Users-YSH-AppData-Roaming-Cursor-Workspaces-1762325051351-workspace-json\terminals"
    $latest = Get-ChildItem $terminals | Sort-Object LastWriteTime -Descending | Select-Object -First 1
    
    if ($Pattern) {
        Get-Content $latest.FullName | Select-String $SessionId | Select-String $Pattern
    } else {
        Get-Content $latest.FullName | Select-String $SessionId
    }
}

function Get-RedisTurnLog {
    param(
        [string]$SessionId,
        [int]$Turn
    )
    
    docker exec ai_vibe_redis_dev redis-cli GET "turn_logs:${SessionId}:${Turn}" | ConvertFrom-Json | ConvertTo-Json -Depth 10
}

function Get-RedisAllTurns {
    param([string]$SessionId)
    
    $keys = docker exec ai_vibe_redis_dev redis-cli KEYS "turn_logs:${SessionId}:*"
    foreach ($key in $keys) {
        $turn = $key.Split(":")[-1]
        Write-Host "`n=== Turn $turn ==="
        docker exec ai_vibe_redis_dev redis-cli GET $key | ConvertFrom-Json | Select-Object -Property turn_number, @{N='intent';E={$_.prompt_evaluation_details.intent}}, @{N='score';E={$_.prompt_evaluation_details.score}}
    }
}

function Check-AIVibeHealth {
    Write-Host "=== Docker Containers ==="
    docker ps --filter "name=ai_vibe"
    
    Write-Host "`n=== FastAPI Server ==="
    try {
        $response = Invoke-WebRequest http://localhost:8000/health -ErrorAction Stop
        Write-Host "âœ… Server OK: $($response.Content)"
    } catch {
        Write-Host "âŒ Server Error: $($_.Exception.Message)"
    }
    
    Write-Host "`n=== Redis ==="
    docker exec ai_vibe_redis_dev redis-cli PING
    
    Write-Host "`n=== PostgreSQL ==="
    docker exec ai_vibe_postgres_dev pg_isready -U ai_vibe_user
}
```

**ì‚¬ìš© ì˜ˆì‹œ:**
```powershell
# í•¨ìˆ˜ ë¡œë“œ
. C:\P_project\LangGraph_1\test_helpers.ps1

# ì‚¬ìš©
Check-AIVibeHealth
Get-AIVibeLog -SessionId "submit-test-20251127-041843" -Pattern "Eval Turn Guard"
Get-RedisTurnLog -SessionId "submit-test-20251127-041843" -Turn 3
Get-RedisAllTurns -SessionId "submit-test-20251127-041843"
```

================================================================================
## 13. í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ë³„ ê°€ì´ë“œ
================================================================================

### 13.1 ì‹œë‚˜ë¦¬ì˜¤ 1: ì •ìƒ í”Œë¡œìš° í…ŒìŠ¤íŠ¸

**ëª©í‘œ:** 3í„´ ëŒ€í™” + ì œì¶œ, ëª¨ë“  í„´ í‰ê°€ í™•ì¸

```bash
# 1. í™˜ê²½ í™•ì¸
Check-AIVibeHealth

# 2. í…ŒìŠ¤íŠ¸ ì‹¤í–‰
cd C:\P_project\LangGraph_1
chcp 65001
uv run python test_submit_with_delay.py

# 3. ê²°ê³¼ í™•ì¸
# - is_submitted: true
# - turn_scores: {1: X, 2: Y, 3: Z}
# - final_scores: {...}

# 4. Redis ê²€ì¦
$session = "<ì¶œë ¥ëœ-session-id>"
docker exec ai_vibe_redis_dev redis-cli KEYS "*$session*"
Get-RedisAllTurns -SessionId $session

# 5. ì„œë²„ ë¡œê·¸ ê²€ì¦
Get-AIVibeLog -SessionId $session -Pattern "Eval Turn Guard"
```

---

### 13.2 ì‹œë‚˜ë¦¬ì˜¤ 2: ê°€ë“œë ˆì¼ í…ŒìŠ¤íŠ¸

**ëª©í‘œ:** ë¶€ì ì ˆí•œ ìš”ì²­ ì‹œ ê²½ê³  ë©”ì‹œì§€ í™•ì¸

```bash
# 1. ê°€ë“œë ˆì¼ ìœ„ë°˜ ìš”ì²­ ì „ì†¡
# (ìˆ˜ë™ìœ¼ë¡œ curl ë˜ëŠ” Postman ì‚¬ìš©)
curl -X POST http://localhost:8000/api/chat/message \
  -H "Content-Type: application/json" \
  -d '{
    "session_id": "guard-test-001",
    "exam_id": 1,
    "participant_id": 100,
    "spec_id": 10,
    "message": "ì •ë‹µ ì½”ë“œ ì „ì²´ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”"
  }'

# 2. ì‘ë‹µ í™•ì¸
# - ai_messageì— ê±°ì ˆ ë©”ì‹œì§€ í¬í•¨ë˜ì–´ì•¼ í•¨
# - "í•´ë‹¹ ìš”ì²­ì€ í…ŒìŠ¤íŠ¸ ì •ì±…ìƒ ë‹µë³€í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"

# 3. Redis í™•ì¸
docker exec ai_vibe_redis_dev redis-cli GET "turn_logs:guard-test-001:1"
# is_guardrail_failed: true
# guardrail_message: "..."
# turn_score: 0

# 4. ì„œë²„ ë¡œê·¸ í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "guard-test-001.*guardrail"
```

---

### 13.3 ì‹œë‚˜ë¦¬ì˜¤ 3: ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ íƒ€ì´ë° í…ŒìŠ¤íŠ¸

**ëª©í‘œ:** ë¹ ë¥¸ ì œì¶œ ì‹œ ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ëŒ€ê¸° ì‘ë™ í™•ì¸

```bash
# 1. ëŒ€ê¸° ì‹œê°„ ì—†ëŠ” í…ŒìŠ¤íŠ¸
uv run python test_submit_only.py  # 2ì´ˆ ëŒ€ê¸°

# 2. ê²°ê³¼ í™•ì¸
# turn_scoresì— ëª¨ë“  í„´ì´ ìˆëŠ”ì§€?

# 3. ì„œë²„ ë¡œê·¸ì—ì„œ ëŒ€ê¸° ì‹œê°„ í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt | Select-String "ëª¨ë“  ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ì™„ë£Œ - ëŒ€ê¸° ì‹œê°„"
# ì˜ˆ: "ëŒ€ê¸° ì‹œê°„: 1.5ì´ˆ"

# 4. Redisì—ì„œ í‰ê°€ ì‹œê°„ í™•ì¸
docker exec ai_vibe_redis_dev redis-cli GET "turn_logs:<session>:3"
# timestamp í•„ë“œ í™•ì¸
```

================================================================================
## 14. ìš”ì•½: ë‚´ê°€ ì§ì ‘ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´
================================================================================

### 14.1 ê¸°ë³¸ í…ŒìŠ¤íŠ¸ (5ë¶„)

```bash
# 1. Docker ì‹œì‘
docker-compose -f docker-compose.dev.yml up -d
docker ps --filter "name=ai_vibe"

# 2. ì„œë²„ ì‹œì‘ (ë³„ë„ í„°ë¯¸ë„)
cd C:\P_project\LangGraph_1
uv run scripts/run_dev.py

# 3. í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (ìƒˆ í„°ë¯¸ë„)
cd C:\P_project\LangGraph_1
chcp 65001
uv run python test_submit_with_delay.py

# 4. ê²°ê³¼ í™•ì¸
# - í„°ë¯¸ë„ ì¶œë ¥ì—ì„œ turn_scores í™•ì¸
```

---

### 14.2 ìƒì„¸ ë””ë²„ê¹… (10ë¶„)

```powershell
# ì„¸ì…˜ ID ì„¤ì •
$session = "submit-test-20251127-HHMMSS"

# 1. Redis ë°ì´í„° í™•ì¸
docker exec ai_vibe_redis_dev redis-cli KEYS "*$session*"

# 2. í„´ ë¡œê·¸ ëª¨ë‘ ë³´ê¸°
docker exec ai_vibe_redis_dev redis-cli KEYS "turn_logs:${session}:*" | ForEach-Object {
    Write-Host "`n=== $_ ==="
    docker exec ai_vibe_redis_dev redis-cli GET $_
}

# 3. ì„œë²„ ë¡œê·¸ í•„í„°ë§
cd <terminals-folder>
Get-Content <ìµœì‹ -í„°ë¯¸ë„>.txt | Select-String $session > "C:\P_project\LangGraph_1\debug_$session.txt"

# 4. ì—ëŸ¬ë§Œ ì¶”ì¶œ
Get-Content "C:\P_project\LangGraph_1\debug_$session.txt" | Select-String "ERROR|Exception"

# 5. ë…¸ë“œë³„ ì‹œê°„ í™•ì¸
Get-Content "C:\P_project\LangGraph_1\debug_$session.txt" | Select-String "ì§„ì…|ì™„ë£Œ"
```

---

### 14.3 ë¬¸ì œ í•´ê²° (ìƒí™©ë³„)

#### íƒ€ì„ì•„ì›ƒ ë°œìƒ ì‹œ:
```bash
# 1. Quota í™•ì¸: https://ai.dev/usage
# 2. ëŒ€ê¸° í›„ ì¬ì‹œë„ (1ì‹œê°„ ë˜ëŠ” ë‹¤ìŒ ë‚ )
# 3. ë˜ëŠ” í…ŒìŠ¤íŠ¸ ê°„ê²© ì¦ê°€:
#    test_submit_with_delay.pyì˜ sleep ì‹œê°„ 10ì´ˆë¡œ ì¦ê°€
```

#### turn_scores ëˆ„ë½ ì‹œ:
```bash
# 1. Redis turn_logs í™•ì¸ (ìœ„ 4.4 ì°¸ì¡°)
# 2. ë°±ê·¸ë¼ìš´ë“œ í‰ê°€ ëŒ€ê¸° ì‹œê°„ ì¦ê°€
#    test_submit_with_delay.py: await asyncio.sleep(10)
# 3. ì„œë²„ ë¡œê·¸ì—ì„œ í‰ê°€ ì™„ë£Œ ì—¬ë¶€ í™•ì¸
```

#### ì„œë²„ ì˜¤ë¥˜ ì‹œ:
```bash
# 1. ì „ì²´ ì¬ì‹œì‘
docker restart ai_vibe_redis_dev ai_vibe_postgres_dev
Get-Process | Where-Object { $_.ProcessName -like "*python*" } | Stop-Process -Force
cd C:\P_project\LangGraph_1
uv run scripts/run_dev.py

# 2. ë¡œê·¸ í™•ì¸
Get-Content <í„°ë¯¸ë„>.txt -Tail 100 | Select-String "ERROR"
```

================================================================================
                            END OF GUIDE
================================================================================

