# AI Vibe Coding Test Worker

LangGraph ê¸°ë°˜ AI ì½”ë”© í…ŒìŠ¤íŠ¸ í‰ê°€ ì‹œìŠ¤í…œ (FastAPI)

## ğŸ“‹ ê°œìš”

ì´ í”„ë¡œì íŠ¸ëŠ” AI ë°”ì´ë¸Œ ì½”ë”© í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ FastAPI ê¸°ë°˜ AI ì›Œì»¤ ì„œë²„ì…ë‹ˆë‹¤. 
Spring Boot ë°±ì—”ë“œì™€ í†µí•©ë˜ì–´ ë™ì‘í•˜ë©°, LangGraphë¥¼ ì‚¬ìš©í•˜ì—¬ ë³µì¡í•œ AI í‰ê°€ í”Œë¡œìš°ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Spring Boot   â”‚â”€â”€â”€â”€â–¶â”‚   AI Worker     â”‚â”€â”€â”€â”€â–¶â”‚   PostgreSQL    â”‚
â”‚   (ë°±ì—”ë“œ)       â”‚     â”‚   (FastAPI)     â”‚     â”‚   (ê³µìœ  DB)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚     Redis       â”‚
                        â”‚  (ìƒíƒœ ê´€ë¦¬)     â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š LangGraph í”Œë¡œìš°

### ë©”ì¸ ê·¸ë˜í”„

```
START
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Handle Request       â”‚ â† ìƒíƒœ ë¡œë“œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Intent Analyzer      â”‚ â† ì˜ë„ ë¶„ì„ & ê°€ë“œë ˆì¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â”œâ”€â”€â–¶ PASSED_HINT â”€â”€â–¶ Writer LLM
  â”œâ”€â”€â–¶ PASSED_SUBMIT â”€â”€â–¶ í‰ê°€ ì§„í–‰
  â””â”€â”€â–¶ FAILED_* â”€â”€â–¶ Handle Failure
  
  â”‚ (Writer LLM ì„±ê³µ ì‹œ)
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Eval Turn SubGraph   â”‚ â† ì‹¤ì‹œê°„ í„´ í‰ê°€
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Main Router          â”‚ â† ì œì¶œ ì—¬ë¶€ í™•ì¸
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â”œâ”€â”€â–¶ is_submitted=True â”€â”€â–¶ ìµœì¢… í‰ê°€
  â””â”€â”€â–¶ is_submitted=False â”€â”€â–¶ ëŒ€í™” ê³„ì†

  â”‚ (ì œì¶œ ì‹œ)
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6a. Holistic Flow Eval  â”‚
â”‚ 6b. Aggregate Scores    â”‚ â† ë³‘ë ¬ í‰ê°€
â”‚ 6c. Code Performance    â”‚
â”‚ 6d. Code Correctness    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. Final Score Agg      â”‚ â† ìµœì¢… ì ìˆ˜ ì‚°ì¶œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
 END
```

### Eval Turn SubGraph (7ê°€ì§€ ì½”ë“œ íŒ¨í„´ ë¶„ë¥˜)

- **RULE_SETTING**: ê·œì¹™ ì„¤ì •
- **GENERATION**: ì½”ë“œ ìƒì„±
- **OPTIMIZATION**: ìµœì í™”
- **DEBUGGING**: ë””ë²„ê¹…
- **TEST_CASE**: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤
- **HINT_OR_QUERY**: íŒíŠ¸/ì§ˆì˜
- **FOLLOW_UP**: í›„ì† ì§ˆë¬¸

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
ai_vibe_worker/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                  # FastAPI ì•±
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ routes/
â”‚   â”‚       â”œâ”€â”€ chat.py          # ì±„íŒ… API
â”‚   â”‚       â”œâ”€â”€ session.py       # ì„¸ì…˜ API
â”‚   â”‚       â””â”€â”€ health.py        # í—¬ìŠ¤ ì²´í¬
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ config.py            # í™˜ê²½ ì„¤ì •
â”‚   â”‚   â””â”€â”€ security.py          # ë³´ì•ˆ
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ session.py           # PostgreSQL ì„¸ì…˜
â”‚   â”‚   â”œâ”€â”€ redis_client.py      # Redis í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ models/              # DB ëª¨ë¸
â”‚   â”‚   â””â”€â”€ repositories/        # ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ
â”‚   â”œâ”€â”€ langgraph/
â”‚   â”‚   â”œâ”€â”€ graph.py             # ë©”ì¸ ê·¸ë˜í”„
â”‚   â”‚   â”œâ”€â”€ subgraph_eval_turn.py # í„´ í‰ê°€ ì„œë¸Œê·¸ë˜í”„
â”‚   â”‚   â”œâ”€â”€ states.py            # ìƒíƒœ ì •ì˜
â”‚   â”‚   â””â”€â”€ nodes/               # ê·¸ë˜í”„ ë…¸ë“œë“¤
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ eval_service.py      # í‰ê°€ ì„œë¹„ìŠ¤
â”‚   â”‚   â””â”€â”€ callback_service.py  # Spring ì½œë°±
â”‚   â””â”€â”€ schemas/                 # Pydantic ëª¨ë¸
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ init-db.sql              # DB ì´ˆê¸°í™”
â”‚   â””â”€â”€ run_dev.py               # ê°œë°œ ì„œë²„
â”œâ”€â”€ tests/
â”œâ”€â”€ docker-compose.yml           # í”„ë¡œë•ì…˜ êµ¬ì„±
â”œâ”€â”€ docker-compose.dev.yml       # ê°œë°œ êµ¬ì„±
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

## ğŸš€ ì‹œì‘í•˜ê¸°

### 1. í™˜ê²½ ì„¤ì •

```bash
# í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ìƒì„±
cp env.example .env

# .env íŒŒì¼ ìˆ˜ì • (API í‚¤ ë“± ì„¤ì •)
```

### 2. ë¡œì»¬ ê°œë°œ (Dockerë¡œ DBë§Œ ì‹¤í–‰)

```bash
# PostgreSQL, Redis ì‹¤í–‰
docker-compose -f docker-compose.dev.yml up -d

# ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”
python -m venv venv
.\venv\Scripts\activate  # Windows
# source venv/bin/activate  # Linux/Mac

# ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt

# ê°œë°œ ì„œë²„ ì‹¤í–‰
python scripts/run_dev.py
```

### 3. Docker Composeë¡œ ì „ì²´ ì‹¤í–‰

```bash
# ì „ì²´ ì„œë¹„ìŠ¤ ì‹¤í–‰
docker-compose up -d

# ë¡œê·¸ í™•ì¸
docker-compose logs -f ai_worker
```

## ğŸ“¡ API ì—”ë“œí¬ì¸íŠ¸

### í—¬ìŠ¤ ì²´í¬
- `GET /` - API ì •ë³´
- `GET /health` - í—¬ìŠ¤ ì²´í¬

### ì±„íŒ… API
- `POST /api/chat/message` - ë©”ì‹œì§€ ì „ì†¡
- `POST /api/chat/submit` - ì½”ë“œ ì œì¶œ

### ì„¸ì…˜ API
- `GET /api/session/{session_id}/state` - ì„¸ì…˜ ìƒíƒœ ì¡°íšŒ
- `GET /api/session/{session_id}/scores` - ì ìˆ˜ ì¡°íšŒ
- `GET /api/session/{session_id}/history` - ëŒ€í™” íˆìŠ¤í† ë¦¬
- `DELETE /api/session/{session_id}` - ì„¸ì…˜ ì‚­ì œ

## ğŸ“ API ë¬¸ì„œ

ì„œë²„ ì‹¤í–‰ í›„:
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

## ğŸ”§ í™˜ê²½ ë³€ìˆ˜

| ë³€ìˆ˜ëª… | ì„¤ëª… | ê¸°ë³¸ê°’ |
|--------|------|--------|
| `DEBUG` | ë””ë²„ê·¸ ëª¨ë“œ | `false` |
| `POSTGRES_HOST` | PostgreSQL í˜¸ìŠ¤íŠ¸ | `localhost` |
| `REDIS_HOST` | Redis í˜¸ìŠ¤íŠ¸ | `localhost` |
| `GEMINI_API_KEY` | Gemini API í‚¤ | - |
| `SPRING_CALLBACK_URL` | Spring ì½œë°± URL | `http://localhost:8080/api/ai/callback` |

## ğŸ† í‰ê°€ ì ìˆ˜ êµ¬ì„±

ìµœì¢… ì ìˆ˜ëŠ” ë‹¤ìŒ í•­ëª©ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:

| í•­ëª© | ê°€ì¤‘ì¹˜ | ì„¤ëª… |
|------|--------|------|
| í”„ë¡¬í”„íŠ¸ í™œìš© | 25% | í„´ ì ìˆ˜ + Holistic Flow |
| ì„±ëŠ¥ | 25% | ì½”ë“œ íš¨ìœ¨ì„± (Judge0) |
| ì •í™•ì„± | 50% | í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ í†µê³¼ìœ¨ |

## ğŸ§ª í…ŒìŠ¤íŠ¸

```bash
# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
pytest tests/ -v

# ì»¤ë²„ë¦¬ì§€ í¬í•¨
pytest tests/ -v --cov=app
```

## ğŸ³ Docker ë°°í¬

```bash
# ì´ë¯¸ì§€ ë¹Œë“œ
docker build -t ai-vibe-worker .

# ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker run -d -p 8000:8000 --env-file .env ai-vibe-worker
```

## ğŸ“š ê¸°ìˆ  ìŠ¤íƒ

- **FastAPI**: ë¹„ë™ê¸° ì›¹ í”„ë ˆì„ì›Œí¬
- **LangGraph**: AI ì›Œí¬í”Œë¡œìš° ì—”ì§„
- **LangChain**: LLM í†µí•©
- **SQLAlchemy**: ORM (ë¹„ë™ê¸°)
- **Redis**: ìƒíƒœ ê´€ë¦¬
- **PostgreSQL**: ì˜êµ¬ ì €ì¥ì†Œ

## ğŸ“„ ë¼ì´ì„ ìŠ¤

Private - ë‚´ë¶€ ì‚¬ìš© ì „ìš©


